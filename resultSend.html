<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>è³‡æ–™é€å‡ºä¸­â€¦</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
body {
  font-family: "Noto Sans TC", sans-serif;
  text-align: center;
  background: #e9eef6;
  padding: 60px 20px;
  font-size: 20px;
}
</style>
</head>

<body>
<p>æ­£åœ¨é€å‡ºæ‚¨çš„é ç´„è³‡æ–™â€¦</p>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzOTOJTDCJNjTW-j_QAzTBQfsVukcIiVLeQwrGjgkmXR1vVQ0XTYdGn0FvovULfFIC0/exec";

(async () => {
  await liff.init({ liffId:"2008586106-kLrdO1gp", withLoginOnExternalBrowser:false });

  const url = new URL(location.href);
  const data = {
    uid: url.searchParams.get("uid"),
    name: url.searchParams.get("name"),
    phone: url.searchParams.get("phone"),
    date: url.searchParams.get("date"),
    time: url.searchParams.get("time"),
    adult: url.searchParams.get("adult"),
    child: url.searchParams.get("child") || "0",
    chair: url.searchParams.get("chair") || "0",
    note: url.searchParams.get("note") || "ç„¡"
  };

  // å¯«å…¥è©¦ç®—è¡¨ï¼ˆå« Content-Typeï¼‰
  try {
    await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type":"application/json" },
      body: JSON.stringify(data)
    });
  } catch(e){ console.error("GAS éŒ¯èª¤", e); }

  // å‚³æ–‡å­—è¨Šæ¯
  const msg =
`ğŸ“Œ æ‚¨çš„é ç´„è¨‚ä½è³‡è¨Š

ğŸ‘¤ å§“åï¼š${data.name}
ğŸ“± æ‰‹æ©Ÿï¼š${data.phone}
ğŸ“… æ—¥æœŸï¼š${data.date}
â° æ™‚æ®µï¼š${data.time}
ğŸ§‘ å¤§äººï¼š${data.adult} ä½
ğŸ§’ å°å­©ï¼š${data.child} ä½
ğŸª‘ å…’ç«¥æ¤…ï¼š${data.chair} å¼µ
ğŸ“ å‚™è¨»ï¼š${data.note}

æˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„é ç´„ï¼Œå°‡ç›¡å¿«èˆ‡æ‚¨ç¢ºèªè¨‚ä½ï¼`;

  try {
    if (liff.isInClient()) {
      await liff.sendMessages([{ type:"text", text:msg }]);
      liff.closeWindow();
    } else {
      document.body.innerHTML = "<p>è³‡æ–™å·²é€å‡ºï¼Œè«‹å› LINE æŸ¥çœ‹ã€‚</p>";
    }
  } catch(e){
    alert("è¨Šæ¯ç™¼é€å¤±æ•—ï¼š" + e);
  }
})();
</script>

</body>
</html>
