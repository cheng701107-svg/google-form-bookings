<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>預約完成</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="style.css" />
<script src="api.js"></script>
</head>

<body>

<div class="header">預約成功</div>

<div class="container">

  <div class="card success-box">

    <div class="success-icon">✔</div>

    <h2 style="margin-top:20px;">您的預約已完成！</h2>

    <p style="color:#5f6368;">
      感謝您的預約，我們已收到您的訂單。
    </p>

    <div id="summaryBox" style="margin-top: 30px; text-align:left;"></div>

    <button class="btn" style="margin-top:30px;" onclick="goHome()">
      返回首頁
    </button>

  </div>

</div>

<script src="api.js"></script>

<script>
const orderId = localStorage.getItem("order_id");
const roomId  = localStorage.getItem("selected_room");
const checkin = localStorage.getItem("checkin");
const nights  = Number(localStorage.getItem("nights"));

if (!orderId) {
  alert("查無訂單資料");
  window.location.href = "index.html";
}

const checkout = addDays(checkin, nights);
const summaryBox = document.getElementById("summaryBox");

async function loadSummary() {
  const res = await apiGet("?action=rooms");
  const room = res.rooms.find(r => r.room_id == roomId);

  const amount = room.price * nights;

  summaryBox.innerHTML = `
    <div style="margin-bottom:12px;"><b>訂單編號：</b>${orderId}</div>
    <div style="margin-bottom:12px;"><b>房型：</b>${room.name}</div>
    <div style="margin-bottom:12px;"><b>入住：</b>${checkin}</div>
    <div style="margin-bottom:12px;"><b>退房：</b>${checkout}</div>
    <div style="margin-bottom:12px;"><b>夜數：</b>${nights}</div>
    <div style="margin-bottom:12px; color:#1A73E8; font-size:20px;">
      <b>總金額：NT$ ${amount}</b>
    </div>
  `;
}

loadSummary();

function goHome() {
  window.location.href = "index.html";
}
</script>


</body>
</html>
