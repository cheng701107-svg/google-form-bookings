<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>選擇房型｜Reserve+</title>

<style>
body{background:#F5F7FA;margin:0;font-family:"Noto Sans TC";}
header{background:#4285F4;color:#fff;padding:18px;text-align:center;font-size:20px;font-weight:700;}
#list{padding:22px;max-width:900px;margin:auto;}

.card{
 background:white;border-radius:18px;overflow:hidden;margin-bottom:18px;
 padding:20px;box-shadow:0 4px 20px rgba(0,0,0,.06);cursor:pointer;transition:.25s;
}
.card:hover{transform:translateY(-3px);}

.price{color:#E53935;font-size:20px;font-weight:bold;margin-top:10px;}
.btn{margin-top:14px;background:#4285F4;color:#fff;padding:12px 22px;border-radius:10px;font-size:16px;display:inline-block;}
</style>
</head>

<body>
<header>選擇房型</header>
<div id="list"></div>

<script>
const API="YOUR_GAS_URL";
const p=new URLSearchParams(location.search);
const checkin=p.get("checkin"),checkout=p.get("checkout");
let calendar=[],rooms=[];

async function init(){
 rooms=await fetch(API+"?action=rooms").then(r=>r.json());
 calendar=await fetch(API+"?action=calendar").then(r=>r.json());

 document.getElementById("list").innerHTML=rooms.map(r=>`
  <div class="card" onclick="next('${r.id}')">
   <h2>${r.name}</h2>
   <div class="price">預估價格：$${calcPrice(r)}</div>
   <div>剩餘房數：${r.stock}</div>
   <a class="btn">選擇此房型 →</a>
  </div>
 `).join("");
}

function calcPrice(room){
 let total=0,a=new Date(checkin),b=new Date(checkout);
 const diff=(b-a)/86400000;
 for(let i=0;i<diff;i++){
   let d=new Date(checkin);d.setDate(d.getDate()+i);
   let wd=[0,6].includes(d.getDay());
   total+=wd?room.weekend:room.weekday;
 }
 return total;
}

function next(id){
 location.href=`booking-info.html?room=${id}&checkin=${checkin}&checkout=${checkout}`;
}

init();
</script>
</body>
</html>
