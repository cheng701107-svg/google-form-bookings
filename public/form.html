<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>填寫預約資料</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body { font-family: sans-serif; padding: 20px; }
  input {
    padding: 14px;
    font-size: 18px;
    width: 100%;
    margin-bottom: 16px;
  }
  button {
    width: 100%;
    background: #007bff;
    color: white;
    font-size: 20px;
    padding: 16px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
  }
</style>
</head>

<body>

<h2>填寫預約資料</h2>

<div id="info"></div>

<input id="name" placeholder="姓名（必填）">
<input id="phone" placeholder="手機（必填）">
<input id="nights" type="number" placeholder="入住晚數（必填）">

<button onclick="submitOrder()">送出訂單</button>

<script>
const API = "https://script.google.com/macros/s/AKfycbx72JGTk3CuJe-z4AFdFm6N1OPJO0aIXq0fgjHY0DN1lCq7iHUtgEZu-YB7fiPP1t2J/exec";

const params = new URLSearchParams(location.search);
const roomId = params.get("roomId");
const checkIn = params.get("checkIn");

document.getElementById("info").innerHTML =
  `房型：${roomId}<br>入住日期：${checkIn}<br><br>`;

async function submitOrder() {
  const body = {
    roomId,
    checkIn,
    nights: document.getElementById("nights").value,
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value
  };

  if (!body.name || !body.phone || !body.nights) {
    alert("請填寫完整資料");
    return;
  }

  const res = await fetch(API + "?action=createOrder", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(body)
  });

  const json = await res.json();

  if (!json.success) {
    alert("送出失敗");
    return;
  }

  alert("預訂成功！訂單編號：" + json.orderId);
  location.href = "index.html";
}
</script>

</body>
</html>
